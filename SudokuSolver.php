<!DOCTYPE html>
    <html lang="en">
        <head>
            <meta charset="utf-8">
            <style>
                td {
                    padding: 0;
                }
                input.cell {
                    font-size: 16pt;
                    text-align: center;
                }
                .cell {
                    border: 1px black solid;
                    width: 1.7em;
                    height: 1.7em;
                }
            </style>
        </head>
        <body>
            <form action="" method="post" >
                <table style = "border-spacing: 0;">
                    <thead></thead>
                    <tbody><tr>
                        <td>
                            <input class="cell" name="array[0][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[0][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[0][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[0][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[0][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[0][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[0][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[0][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[0][]" maxlength="1" autocomplete="off">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <input class="cell" name="array[1][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[1][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[1][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[1][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[1][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[1][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[1][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[1][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[1][]" maxlength="1" autocomplete="off">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <input class="cell" name="array[2][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[2][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[2][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[2][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[2][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[2][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[2][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[2][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[2][]" maxlength="1" autocomplete="off">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <input class="cell" name="array[3][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[3][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[3][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[3][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[3][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[3][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[3][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[3][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[3][]" maxlength="1" autocomplete="off">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <input class="cell" name="array[4][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[4][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[4][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[4][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[4][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[4][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[4][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[4][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[4][]" maxlength="1" autocomplete="off">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <input class="cell" name="array[5][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[5][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[5][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[5][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[5][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[5][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[5][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[5][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[5][]" maxlength="1" autocomplete="off">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <input class="cell" name="array[6][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[6][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[6][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[6][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[6][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[6][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[6][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[6][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[6][]" maxlength="1" autocomplete="off">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <input class="cell" name="array[7][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[7][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[7][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[7][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[7][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[7][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[7][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[7][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[7][]" maxlength="1" autocomplete="off">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <input class="cell" name="array[8][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[8][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[8][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[8][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[8][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[8][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[8][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[8][]" maxlength="1" autocomplete="off">
                        </td>
                        <td>
                            <input class="cell" name="array[8][]" maxlength="1" autocomplete="off">
                        </td>
                    </tr>
                    <tr>
                    </tr>
                    <tr>
                        <td style="padding-top:10px" colspan="9" align="center">
                            <input class="btn btn-success  btn-lg " type="submit" value="Solve" onclick="javascript:solve()">
                        </td>
                    </tr>
                    </tbody>
                </table>
            </form>
        </body>
</html>
<?php
if ( !empty($_POST) && is_array($_POST) && is_array($_POST['array']) && count($_POST['array']) == 9) {
    $array = array();
    foreach ($_POST['array'] as $value) {
        $array[] = array_map('intval', $value);
    }

    try {
        (new SudokuSolver())->solve($array);
    } catch (\Exception $exception) {
        echo $exception->getMessage();
    }
}

class SudokuSolver
{
    /**
     * @var array
     */
    private $possibilityArray;
    /**
     * @var array
     */
    private $storedArrays;
    /**
     * @var int
     */
    private $key;
    /**
     * @var mixed
     */
    private $startTime;
    /**
     * @var bool
     */
    private $arrayChecked = false;

    /**
     * SudokuSolver constructor.
     * @param array $possibilityArray
     * @param array $storedArrays
     * @param int $key
     */
    public function __construct(array $possibilityArray = array(), array $storedArrays = array(), int $key = 0)
    {
        $this->possibilityArray = $possibilityArray;
        $this->storedArrays = $storedArrays;
        $this->key = $key;
        $this->startTime = microtime(true);
    }

    /**
     * @param array $originalArray
     * @throws Exception
     */
    public function solve(array $originalArray)
    {
        if ($this->arrayChecked == false) {
            $this->arrayChecked = true;
            $this->checkOriginalArray($originalArray);
        }
        $comparedArray = $this->compareAllowed($originalArray);

        if ($comparedArray == false) {
            $this->setPossibilities($this->storedArrays[$this->key]);
        } else if ($comparedArray == $originalArray) {
            $this->key++;
            $this->storedArrays[$this->key] = $originalArray;
            $this->setPossibilities($originalArray);
        }

        for ($h = 0; $h < count($comparedArray); $h++) {
            if(in_array(0, $comparedArray[$h])) {
                $this->solve($comparedArray);
            }
        }
        $endTime = microtime(true);
        $time = $endTime - $this->startTime;
        echo "Congratulations! The puzzle has been solved in no time! :) <br/'> Actually for $time seconds!!! :)";
        exit;
    }

    /**
     * @param array $originalArray
     * @throws Exception
     */
    private function checkOriginalArray(array $originalArray):void
    {
        if (count($originalArray) != 9) {
            throw new \Exception("You must provide a full sudoku puzzle in order to get solved (rows missing)!");
        }
        foreach ($originalArray as $array){
            if (count($array) != 9) {
                throw new \Exception("You must provide a full sudoku puzzle in order to get solved (cell missing)!");
            }
        }
    }

    /**
     * @param array $originalArray
     * @throws Exception
     */
    private function setPossibilities(array $originalArray): void
    {
        $allowedArray = $this->getAllowed($originalArray);

        //get the array and start guessing
        for ($h = 0; $h < count($originalArray); $h++) {
            for ($i = 0; $i < count($allowedArray[$h]); $i++) {
                for ($k = 1; $k < count($allowedArray[$h][$i]); $k++) {
                    if (!isset($this->possibilityArray[$h][$i])) {
                        $this->possibilityArray[$h][$i] = 0;
                    }
                    $this->possibilityArray[$h][$i]++;
                    if (!isset($allowedArray[$h][$i][(int)$this->possibilityArray[$h][$i] - 1])) {
                        $this->possibilityArray[$h][$i] = 0;
                        $this->key--;
                        $this->setPossibilities($this->storedArrays[$this->key]);
                    } else {
                        $originalArray[$h][$i] = $allowedArray[$h][$i][(int)$this->possibilityArray[$h][$i] - 1];
                        $this->solve($originalArray);
                    }
                }
                
            }
        }
    }

    /**
     * @param array $array
     * @return array
     * @throws Exception
     */
    private function getAllowed(array $array): array
    {
        $newarray = array();
        $col = 0;
        $row = 0;
        for ($r = 0; $r < count($this->getAllowedByRow($array)); $r++) {
            $intarray = array_intersect($this->getAllowedByRow($array)[$r], $this->getAllowedByColumn($array)[$r], $this->getAllowedBySquare($array)[$r]);
            if (count($intarray) > 0) {
                foreach ($intarray as $value) {
                    $newarray[$row][$col][] = $value;
                }
                $col++;
                if ($col == 9) {
                    $col = 0;
                    $row++;
                }
            }
        }
        return $newarray;
    }

    /**
     * This method output the step excluding the step that return false
     *
     * @throws Exception
     * @param array $array
     * @return array|false
     */
    private function compareAllowed(array $array)
    {
        $newarray = $array;

        $col = 0;
        $row = 0;
        $rowEnd = 0;

        $html = '<table border=1>';

        for ($r = 0; $r < count($this->getAllowedByRow($array)); $r++) {
            $intarray = array_intersect($this->getAllowedByRow($newarray)[$r], $this->getAllowedByColumn($newarray)[$r], $this->getAllowedBySquare($newarray)[$r]);
            $html .= '<td>';
            foreach ($intarray as $mn) {
                $html .= $mn;
            }
            $html .= '</td>';
            $rowEnd++;
            if ($rowEnd == 9 || $rowEnd == 18 || $rowEnd == 27 || $rowEnd == 36 || $rowEnd == 45 || $rowEnd == 54 || $rowEnd == 63 || $rowEnd == 72 || $rowEnd == 81) {
                $html .= '</tr>';
            }
            $result = count($intarray);
            if ($result < 1) {
                //uncomment this if you want to see where it fails end return to the next possibility
                //echo "No result!! Means that there is no possibilities for this cell!";
                return false;
            }

            if ($result < 2) {
                foreach ($intarray as $value)
                    $newarray[$row][$col] = $value;
                $col++;
            } else {
                $newarray[$row][$col] = 0;
                $col++;
            }
            if ($col == 9) {
                $col = 0;
                $row++;
            }
        }
        $html .= '</table>';
        echo $html;
        return $newarray;
    }

    /**
     * @param array $array
     * @return array
     * @throws Exception
     */
    private function getAllowedByRow(array $array)
    {
        $arraytemprow = array();
        $row = 0;
        $column = 0;
        for ($h = 0; $h < count($array); $h++) {
            foreach ($array[$h] as $value) {
                if ($value === 0) {
                    for ($n = 1; $n <= 9; $n++) {
                        if (!in_array($n, $array[$h])) {
                            $arraytemprow[$row][$column] = $n;
                            $column++;
                        }
                        if ($n == 9) {
                            $column = 0;
                            $row++;
                        }
                    }
                } else if (!($value > -1 && $value < 10) || !is_int($value)) {
                    throw new \Exception( "The puzzle contains inconsistent data the values must be number between 1 and 9!");
                } else if (count(array_keys($array[$h], $value)) > 1) {
                    throw new \Exception("The puzzle is not solvable! Check your input (it must not contain duplicated values)!!!");
                } else {
                    $arraytemprow[$row][$column] = $value;
                    $row++;
                }
            }
        }

        return $arraytemprow;
    }

    /**
     * @param array $array
     * @return array
     * @throws Exception
     */
    private function getAllowedByColumn(array $array): array
    {
        $reversedArray = $this->reverseArrayByColumn($array);

        return $this->reverseAllowedByColumn($this->getAllowedByRow($reversedArray));
    }

    private function reverseArrayByColumn(array $array): array
    {
        $reversedArray = array();
        $row = 0;
        $column = 0;
        for ($h = 0; $h < count($array); $h++) {
            foreach ($array[$h] as $valuecolumn) {
                $reversedArray[$column][$row] = $valuecolumn;
                $column++;
                if ($row == 9) {
                    break;
                }
                if ($column == 9) {
                    $column = 0;
                    $row++;
                }
            }
        }
        return $reversedArray;
    }

    private function reverseAllowedByColumn(array $array): array
    {
        $arraycolumnforcompare = array();
        for ($j = 0; $j < 9; $j++) {
            foreach ($array as $key => $value) {
                for ($i = $j; $i < 81; $i = $i + 9) {
                    if ($key == $i) {
                        array_push($arraycolumnforcompare, $value);
                    }
                }
            }
        }
        return $arraycolumnforcompare;
    }

    /**
     * @param array $array
     * @return array
     * @throws Exception
     */
    private function getAllowedBySquare(array $array): array
    {
        $reversedArray = $this->reverseArrayBySquare($array);

        return $this->reverseAllowedBySquare($this->getAllowedByRow($reversedArray));
    }

    private function reverseArrayBySquare (array $array): array
    {
        $square = array();
        $squareDimension = 3;
        $row = 0;
        $m = 0;
        for ($i = 0; $i < $squareDimension; $i++) {
            $column = 0;
            for ($j = 0; $j < $squareDimension; $j++) {
                for ($k = $row; $k < ($row + $squareDimension); $k++) {
                    for ($l = $column; $l < ($column + $squareDimension); $l++) {
                        $square[$m][] = $array[$k][$l];
                    }
                }
                $column += $squareDimension;
                $m++;
            }
            $row += $squareDimension;
        }
        return $square;
    }

    private function reverseAllowedBySquare($array): array
    {
        $arraysquareforcompare = array();
        $p = 0;
        $x = 0;
        for ($j = 0; $j < 81; $j = $j + 9) {
            foreach ($array as $key => $value) {
                for ($i = $j; $i < (3 + $j); $i++) {
                    if ($key == $i) {
                        array_push($arraysquareforcompare, $value);
                    }
                }
            }
            $p++;
            if ($p > 2) {
                $p = 0;
                $j = $j - 24;
                $x++;
                if ($x > 2) {
                    $x = 0;
                    $j = $j + 18;
                }
            }
        }
        return $arraysquareforcompare;
    }
}
//MAY NOT BE THE BEST ALGORITHM ... HOWEVER THIS SUDOKU SOLVER WORKS (LIKE CHARM) WITH BACKTRACKING (task by Kuncho Ivanov)!!! :)